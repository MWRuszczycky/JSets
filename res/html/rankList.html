<!DOCTYPE html>
<html>
    <head>
        <title>@{jsetTitle}</title>
        <meta charset="UTF-8">

<!-- ============================================================ -->
<!-- STYLES -->

        <style>
            body { background-color: white;
                   color: #101010;
                   font-family: sans-serif;
                   font-size: 100%; }
            a:link { color: #4682b4; }
            a:visited { color: #7eaacd; }
            input[type="text"] { width: 1.5em; }
            #inst { padding-left: 1.5em; }
            p { display: block;
                padding-left: 3.5em;
                text-indent: -2.7em; }
        </style>

<!-- ============================================================ -->
<!-- SCRIPTS -->

        <script>

            function isAnInt(x) {
                var intOK = !Number.isNaN(parseInt(x));
                var numOK = !Number.isNaN(x);
                return intOK && numOK;
            };

            function compareRanks(r1, r2) {
                return r1[1] - r2[1];
            };

            function formatRanks(rs) {
                if (rs.length === 0) {
                    return "<br>I have no preferences."
                };

                str = "<br>most preferred : ";

                for (i = 0; i < rs.length; i++) {
                    if (i === rs.length - 1) {
                        str += rs[i][0] + " : least preferred";
                    } else if (rs[i][1] === rs[i + 1][1]) {
                        str += rs[i][0] + " = ";
                    } else {
                        str += rs[i][0] + " > ";
                    };
                };
                return str + "<br><br><br>";
            };

            function createRanks() {
            // Create ranks and update page
                var xs    = document.getElementsByClassName("_citation");
                var ranks = [];
                for (i = 0; i < xs.length; i++) {
                    var v = xs[i].value;
                    if (isAnInt(v)) {
                        ranks.push([i + 1, Number(v)]);
                    }
                };

                ranks.sort(compareRanks);

                var inst     = document.getElementById('inst');
                var rankList = document.getElementById('ranks');
                var rankBtn  = document.getElementById('rankBtn');

                rankList.innerHTML = formatRanks(ranks);
                rankBtn.style      = "display:none";
            };

        </script>

    </head>

<!-- ============================================================ -->
<!-- CONTENT -->

    <body>

<!-- ============================================================ -->
<!-- Tables of Contents -->

        <h1>@{jsetTitle}</h1>

        <h2>Instructions</h2>

        <ol>
            <li>If you have no preferences, you can ignore this.</li>
            <li><b>Rank your articles by entering a number in the adjacent text box.</b></li>
            <li>Don't distinguish between long and short articles in your ranking.</li>
            <li><b>More negative numbers indicate higher preference.</b></li>
            <li>You can use any integers you want. Only the order matters.<br>
                (But you might as well start with your most preferred at 1)</li>
            <li><b>You can give articles equal rank or no rank at all.</b></li>
            <li>Once you're done, click the button at the bottom.</li>
            <li><b>Copy the resulting rank list and paste it into an email to @{name}.</b></li>
            <li>If you want to redo your rankings, just refresh the web page.</li>
        </ol>

        <h2>Selection</h2>

@{citations}
<!-- ============================================================ -->
<!-- Selection -->

        <h2>Create your ranks and send them to @{name}!</h2>

        <div id="inst">
            Press the button to create your rank list and email it to @{name}@{email}.<br>
            If you have no preferences, you don't need to do anything.<br>
            <button type="button" id="rankBtn" onclick="createRanks()">
                Create Ranks!
            </button>
            <b><span id="ranks"></span></b>
        </div>
    </body>
</html>
